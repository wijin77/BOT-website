<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메인 페이지</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 페이지 내용이 로드되기 전에 깜빡이는 것을 방지 */
        body.loading {
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.5s linear;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen loading">

    <!-- 로그인 후 보여줄 메인 콘텐츠 -->
    <div id="main-content" class="w-full max-w-md mx-auto bg-white p-8 rounded-2xl shadow-lg text-center">
        <h1 class="text-3xl font-bold text-blue-600 mb-4">로그인 성공!</h1>
        <p class="text-gray-700 mb-8">메인 페이지에 오신 것을 환영합니다.</p>
        
        <!-- 사용자 프로필 정보 -->
        <div id="user-profile">
            <img id="user-photo" src="https://placehold.co/96x96/E2E8F0/A0AEC0?text=User" alt="사용자 프로필 사진" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-gray-200" onerror="this.onerror=null; this.src='https://placehold.co/96x96/E2E8F0/A0AEC0?text=User';">
            <h2 id="user-name" class="text-xl font-bold text-gray-800"></h2>
            <p id="user-email" class="text-gray-500 mb-6"></p>
            <button id="logout-button" class="w-full bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition duration-300">
                로그아웃
            </button>
        </div>
    </div>

    <!-- Firebase SDK 추가 -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // --------------------------------------------------------------------
        // 중요: 이 설정은 index.html의 설정과 반드시 동일해야 합니다.
        // --------------------------------------------------------------------
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // UI 요소
        const userPhoto = document.getElementById('user-photo');
        const userName = document.getElementById('user-name');
        const userEmail = document.getElementById('user-email');
        const logoutButton = document.getElementById('logout-button');

        // 인증 상태 감지 (이 페이지의 핵심 로직)
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // 사용자가 로그인한 경우, 페이지를 보여주고 정보를 채웁니다.
                document.body.classList.remove('loading');
                userPhoto.src = user.photoURL || 'https://placehold.co/96x96/E2E8F0/A0AEC0?text=User';
                userName.textContent = user.displayName || '사용자';
                userEmail.textContent = user.email;
            } else {
                // 사용자가 로그아웃한 경우, 로그인 페이지로 리디렉션합니다.
                window.location.href = '/'; // 웹사이트의 루트 페이지로 이동
            }
        });

        // 로그아웃 버튼
        logoutButton.addEventListener('click', () => {
            signOut(auth).catch((error) => console.error("로그아웃 에러:", error));
        });
    </script>
</body>
</html>
